import{r as i,a as s,R as e,F as b,b as h,c as p,d as w,u as y,Q as N,e as S,B as T,S as F,f as I,g as A}from"./vendor.bb3df921.js";const P=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};P();const v=i.exports.createContext(void 0),x=t=>{s.defaults.headers.common.Authorization=`JWT ${t}`,localStorage.setItem("jwt",t)},R=({children:t})=>{var f;const[o,n]=i.exports.useState((f=localStorage.getItem("jwt"))!=null?f:""),[l,a]=i.exports.useState("");i.exports.useEffect(()=>{localStorage.getItem("jwt")&&(s.defaults.headers.common.Authorization=`JWT ${localStorage.getItem("jwt")}`)},[]),i.exports.useEffect(()=>{s.interceptors.response.use(m=>{const c=m.headers["X-New-Token"];return c&&(n(c),x(c)),m})},[]);const r=(m,c,d,E)=>{s.post("auth/login",{email:m,password:c}).then(L=>{a(L.data.mfa_required.state),d&&d()}).catch(()=>{E&&E()})},u=(m,c)=>{s.put("auth/login",{token:m,state:l}).then(d=>{n(d.data.token),x(d.data.token),c&&c()})},k=()=>{n(""),localStorage.removeItem("jwt"),delete s.defaults.headers.common.Authorization};return e.createElement(v.Provider,{value:{isLoggedIn:!!o,needToken:!o&&!!l,passwordLogin:r,tokenLogin:u,logout:k}},t)},g=()=>{const{isLoggedIn:t,needToken:o,passwordLogin:n,tokenLogin:l,logout:a}=i.exports.useContext(v);return{isLoggedIn:t,needToken:o,passwordLogin:n,tokenLogin:l,logout:a}},j=()=>{const{passwordLogin:t}=g();return e.createElement("div",null,e.createElement("div",{className:"text-xl font-bold mb-4 w-64"},"Login"),e.createElement(b,{initialValues:{email:"",password:""},onSubmit:o=>t(o.email,o.password)},()=>e.createElement(h,null,e.createElement("div",null,e.createElement(p,{name:"email",placeholder:"email",className:"bg-gray-700 p-4 mb-2 w-full"})),e.createElement("div",null,e.createElement(p,{name:"password",type:"password",placeholder:"password",className:"bg-gray-700 p-4 mb-4 w-full"})),e.createElement("button",{type:"submit",className:"border-gray-700 bg-gray-800 hover:bg-gray-700 w-full p-2"},"Login"))))},C=()=>{const{tokenLogin:t}=g();return e.createElement("div",null,e.createElement("div",{className:"text-xl font-bold mb-4 w-64"},"Token"),e.createElement(b,{initialValues:{token:""},onSubmit:o=>t(o.token)},()=>e.createElement(h,null,e.createElement(p,{name:"token",placeholder:"token",className:"bg-gray-700 p-4 mb-2 w-full"}),e.createElement("button",{type:"submit",className:"border-gray-700 bg-gray-800 hover:bg-gray-700 w-full p-2"},"Login"))))},G=({path:t,children:o})=>{const{isLoggedIn:n,needToken:l}=g();return l?e.createElement(C,null):n?e.createElement(w,{path:t},o):e.createElement(j,null)},O=({id:t,name:o})=>{const{data:n}=y(["portfolioGroups",{id:t}],()=>s.get(`https://api.passiv.com/api/v1/portfolioGroups/${t}/info`));return e.createElement("div",{className:"bg-gray-800 border border-black rounded-lg shadow p-4"},(n==null?void 0:n.data)&&e.createElement(e.Fragment,null,e.createElement("div",{className:"text-xl font-bold"},o),e.createElement("div",null,n.data.accuracy,"%")))},Q=()=>{const{data:t}=y("portfolioGroups",()=>s.get("https://api.passiv.com/api/v1/portfolioGroups/")),{logout:o}=g();return console.log(t),e.createElement(e.Fragment,null,e.createElement("div",{className:"flex gap-2 w-64"},(t==null?void 0:t.data)&&t.data.map(n=>e.createElement(O,{id:n.id,name:n.name,key:n.id}))),e.createElement("button",{onClick:o,className:"text-xs text-gray-600"},"Logout"))},q=()=>{const t=new N;return e.createElement("div",{className:"bg-gray-900 h-screen text-gray-300 flex flex-col"},e.createElement("div",{className:"flex-1"}),e.createElement("div",{className:"max-w-7xl mx-auto"},e.createElement(S,{client:t},e.createElement(T,null,e.createElement(F,null,e.createElement(G,{path:"/"},e.createElement(Q,null)),e.createElement(w,{path:"*"},e.createElement(I,{to:"/"})))))),e.createElement("div",{className:"flex-1"}))};s.defaults.baseURL="https://api.passiv.com/api/v1/";A.render(e.createElement(i.exports.StrictMode,null,e.createElement(R,null,e.createElement(q,null))),document.getElementById("root"));
//# sourceMappingURL=index.2f05bafb.js.map
